

## 网络接口层

**以太网帧首部**

![以太网帧首部](https://i.loli.net/2020/04/07/bdtZV1B98D6pnkE.png)

> - 目的地址/源地址：通信双方的MAC地址，目的地址未知时用`FF:FF:FF:FF:FF:FF`填充
> - 类型：协议类型编码
> - 数据：不超过最大传输单元MTU(1500)字节，因此以太网帧范围为64~1518。MTU的选择是资源占用和效率的综合考量
> - CRC：尾部校验，提供差错控制

**MAC地址：**
> 网卡的硬件地址，6字节48位，前24位用于分配给不同厂商，后24位厂商自己分配，全球唯一。系统中的MAC地址是ARP协议ROM中记录的硬件地址，是可以修改的，因此可能有两个相同的MAC地址

### ARP协议
**作用**：获取局域网中目标主机的物理地址(MAC地址)
> **ARP协议流程**
> 1. 检查ARP缓存表，查看目的主机是否有IP地址对应的目的MAC；
> 2. 目的地址未知时用`FF:FF:FF:FF:FF:FF`填充，并发送广播帧，交换机将广播帧转发
> 3. 所有收到帧的主机会解析目的地址为`FF:FF:FF:FF:FF:FF`的以太帧，如果IP地址符合则接收，并将其IP和MAC记录到ARP缓存表，同时发送ARP应答
> 4. 源主机收到应答后记录目的主机的MAC地址

### RARP协议
**作用**：利用MAC地址获取目标主机的IP地址(已经被DHCP协议取代)
> **RARP协议流程**
> 1. 发送主机发送一个本地的RARP广播，在此广播包中，声明自己的MAC地址并且请求任何收到此请求的RARP服务器分配一个IP地址；
> 2. 本地网段上的RARP服务器收到此请求后，检查其RARP列表，查找该MAC地址对应的IP地址；
> 3. 如果存在，RARP服务器就给源主机发送一个响应数据包并将此IP地址提供给对方主机使用；如果不存在，RARP服务器对此不做任何的响应；
> 4. 源主机收到从RARP服务器的响应信息，就利用得到的IP地址进行通讯；如果一直没有收到RARP服务器的响应信息，表示初始化失败。