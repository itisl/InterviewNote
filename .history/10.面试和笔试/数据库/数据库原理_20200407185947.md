
[TOC]

---
## 第1章 基本概念



### 1.1 数据库体系结构
**数据库体系结构**：
- 数据（data）：描述事物的**符号记录**称为数据。
- 数据库（DataBase，DB）：是长期存储在计算机内、有组织的、可共享的**大量数据的集合**，具有永久存储、有组织、可共享三个基本特点（，数据库即是一个文件）。
- 数据库管理系统（DataBase Management System，DBMS）：是位于用户与操作系统之间的一层**数据管理软件**。
- 数据库系统（DataBase System，DBS）：是有数据库、数据库管理系统（及其应用开发工具）、应用程序和数据库管理员（DataBase Administrator DBA）组成的**存储、管理、处理和维护数据的系统**。
![20200407142511](https://i.loli.net/2020/04/07/8oAuQ6v3ilDWFX1.png)


### 1.2 基本概念

> 1. **实体**：客观存在可相互区别的事物
> 2. **属性**：实体具有的某一特性
> 3. **联系**：实体之间的联系通常是指不同实体集之间的联系。
> 4. **码**：唯一标识实体的属性集。
> 5. **实体型** 比如学生
> 6. **实体集** 比如全体学生
> 8. **模式**（schema）：模式也称逻辑模式，是数据库全体数据的逻辑结构和特征的描述，是所有用户的公共数据视图。
> 9. **外模式**（external schema）：外模式也称子模式（subschema）或用户模式，它是数据库用户（包括应用程序员和最终用户）能够看见和使用的局部数据的逻辑结构和特征的描述，是数据库用户的数据视图，是与某一应用有关的数据的逻辑表示。
> 10. **内模式**（internal schema）：内模式也称为存储模式（storage schema），一个数据库只有一个内模式。他是数据物理结构和存储方式的描述，是数据库在数据库内部的组织方式。

## 第二章 数据模型
### 2.1 常用数据模型
> • 层次模型（hierarchical model）
> • 网状模型（network model）
> • 面向对象数据模型（object oriented data model）
> • 对象关系数据模型（object relational data model）
> • 半结构化数据模型（semistructure data model）
> • **关系模型**（relational model）

### 2.2 关系模型
1. **关系**（relation）：一个关系对应通常说的一张表
2. **元组**（tuple）：表中的一行即为一个元组
3. **属性**（attribute）：表中的一列即为一个属性
4. **码**（key）：表中可以唯一确定一个元组的某个属性组
   - _超码_：能在关系中唯一标志一个元组
   - _候选码_：最小超码
   - _主键_：用户明确定义的候选码，通常用下划线标记
   - _外码_：关系R上的属性B在关系S上是主键，则R上的属性B是参照S的外码，R为外码依赖的参照关系
1. **域**（domain）：一组具有相同数据类型的值的集合$ D_1,D_2,...D_n $
2. **分量**：元组中的一个属性值
3. **关系模式**：对关系的描述，一般表示为 关系名(属性1, 属性2, ..., 属性n)
4. **笛卡儿积**：每个域的基数相乘=行数，$ D_i $域的笛卡尔积$ {D_1}\times{D_2}\times{...}\times{D_n} $





 
### 2.3 关系操作
基本关系操作：
> **查询**：
>   - 选择`Select`  运算符$\sigma $，选择指定条件构成新关系
>   - 投影`Project` 运算符$\Pi$，投影指定属性名构成新关系，去除其中数据重复
>   - 连接(等值连接 自然连接`Natural join` 外连接) 
>   - 除`Division` 
>   - 并`Union` $\cup$
>   - 差`set difference` $-$，去除
>   - 交`Set intersection` $\cap$
>   - 笛卡尔积`Cartesian product` 
> **插入**
> **删除**
> **修改**：赋值`Assignment` 重命名`Rename`

运算符示例：
$\sigma_{A=C}(r \times s) $ 选择属性A=C的
$\Pi_{A,C}(r)$ 投影关系r属性名AC的两列，并去除数据重复




### 3.5 数据更新
#### 3.5.1 插入数据
1. 插入元组

 insert into 表名（属性列，···，···） values（对应的值，···，···）；
 
注意：1. 没有出现的属性列，将自动取空值；但说明了not null 的属性列不能取空值，否则出错
 
     2. 如果没有指明任何属性列， 则新插入的必须在每个属性列上都有值（如果为null要显式给出），且顺序要和表的属性列顺序一样
 
     3.值如果为字符串常数，要用单引号括起来，数字不用
 
     4. 可以把属性列显式的置为NULL
 
例：insert into student（Sno，Sname，Ssex） values（'29193','李明','男'）;
 
 
 
一次同时插入多条数据：
insert into 表名（属性列，···，···） values（对应的值，···，···），
（对应的值2，···，···），
（对应的值3，···，···），
···
；
2. 插入子查询结果

子查询既可以嵌套在select语句中，也可以用在insert语句中用以生成要插入的数据

insert into dept_age(sdept, avg_age) select sdept, avg(sage) from stu group by sdept;
#### 3.5.2 修改数据
1. 修改某一个元组的值

update 表名 set 属性名 = '' where 属性名 = ''；
如：update student set Sage = 16 where Sno = '201215121'；
2. 修改多个元组的值

update 表名 set Sage = Sage + 1；
3. 带子查询的修改语句

update SC set Grade = 0 where Sno in (select Sno from stu where Sdept 'CS');
#### 3.5.3 删除数据
1. 删除一个元组

delete from 表名 where 属性名 = ''；
2. 删除多个元组

delete from 表名；//删除所有，该表成为空表
3. 带子查询的删除语句

delete from SC where Sno in (select Sno from stu where Sdept = 'CS');


 

## 附录：试题
什么是数据库的再组织和重构造？为什么要进行数据库的再组织和重构造？
[参考答案 ] 答：数据库的再组织是指：按原设计要求重新安排存储位置、回收垃圾、减少指针链等， 以提高系统性能。 数据库的重构造则是指部分修改数据库的模式和内模式， 即修改原设计的逻辑和物理结构。数据库的再组织是不修改数
据库的模式和内模式的。 进行数据库的再组织和重构造的原因： 数据库运行一段时间后，由于记录不断 增、删、改，会使数据库的物理存储情况变坏，降低了数 据 的 存 取 效 率 ，数 据库 性能 下 降 ， 这 时 DBA 就 要 对 数 据库 进行 重组织。 DBMS一般都提供用于数据重组织的实用程序。数据库应用环境常常发生变化，如增加新的应用或新的实体， 取消了某些应用， 有的实体与实体间的联系也发生了变化等， 使原有的数据库设计不能满足新的需求，需要调整数据库的模式和内模式。这就要进行数据库重构造

什么是检查点记录？
答：检查点记录是一类新的日志记录。它的内容包括：（1）建立检查点时刻所有正在执行的事务清单；（2）这些事务的最近一个日志记录的地址。

关系系统中，当操作违反实体完整性、参照完整性和用户定义的完整性约束条件时，一般是如何分别进行处理的？
答:
对于违反实体完整性和用户定义的完整性的操作一般都采用拒绝执行的方式进行处理。而对于违反参照完整性的操作，并不都是简单地拒绝执行，有时要根据应用语义执行一些附加的操作，以保证数据库的正确性。

什么是数据库的审计功能，为什么要提供审计功能？
答：审计功能是指 DBMS 的审计模块在用户对数据库执行操作的同时把所有操作自动记录到系统的审计日志中。因为任何系统的安全保护措施都不是完美无缺的，蓄意盗窃破坏数据的人总可能存在。利用数据库的审计功能， DBA 可以根据审计跟踪的信息，重现导致数据库现有状况的一系列事件，找出非法存取数据的人、时间和内容等。

哪类视图是可以更新的？哪类视图是不可更新的？各举一例说明。
答：基本表的行列子集视图一般是可更新的。若视图的属性来自集合函数、表达式，则该视图肯定是不可以更新的。

什么是基本表？什么是视图？两者的区别和联系是什么？
答：基本表是本身独立存在的表， 在 sQL 中一个关系就对应一个表。 视图是从一个或几个基本表导出的表。视图本身不独立存储在数据库中，是一个虚表。即数据库中只存放视图的定义而不存放视图对应的数据，这些数据仍存放在导出视图的基本表中。 视图在概念上与基本表等同， 用户可以如同基本表那样使用视图，可以在视图上再定义视图

 

假设有下面两个关系模式：

职工（职工号，姓名，年龄，职务，工资，部门号） ，其中职工号为主码；

部门（部门号，名称，经理名，电话） ，其中部门号为主码。

用 sQL 语言定义这两个关系模式，要求在模式中完成以下完整性约束条件的定义：

定义每个模式的主码；

定义参照完整性； 定义职工年龄不得超过 60岁。
答
CREATE TABLE DEPT
(Deptno NUMBER(2) PRIMARY KEY,
Deptname VARCHAR(10),
Manager VARCHAR(10),
PhoneNumber Char(12)
);


CREATE TABLE EMP
(Empno NUMBER(4) PRIMARY KEY,
Ename VARCHAR(10),
Age NUMBER(2),
CHECK ( Aage<=60),
Job VARCHAR(9),
Sal FLOAT(6),
Deptno NUMBER(2),
FOREIGN KEY(Deptno)  REFERENCES DEPT(Deptno));

 

什么是数据库中的自主存取控制方法和强制存取控制方法？
答：
自主存取控制方法：定义各个用户对不同数据对象的存取权限。当用户对数据库访问时首先检查用户的存取权限。防止不合法用户对数据库的存取。
强制存取控制方法：每一个数据对象被（强制地）标以一定的密级，每一个用户也被（强制地）授予某一个级别的许可证。系统规定只有具有某一许可证级别的用户才能存取某一个密级的数据对象。

 

试述实现数据库安全性控制的常用方法和技术。
答：实现数据库安全性控制的常用方法和技术有：
( l  ）用户标识和鉴别：该方法由系统提供一定的方式让用户标识自己的名字或身份。每次用户要求进入系统时，由系统进行核对，通过鉴定后才提供系统的使用权。
( 2 ）存取控制：通过用户权限定义和合法权检查确保只有合法权限的用户访问数据库，所有未被授权的人员无法存取数据。例如 CZ 级中的自主存取控制 ( DAC ) , Bl  级中的强制存取控制（ MAC ）。
( 3 ）视图机制：为不同的用户定义视图，通过视图机制把要保密的数据对无权存取的用户隐藏起来，从而自动地对数据提供一定程度的安全保护。
( 4 ）审计：建立审计日志，把用户对数据库的所有操作自动记录下来放入审计日志中， DBA 可以利用审计跟踪的信息，重现导致数据库现有状况的一系列事件，找出非法存取数据的人、时间和内容等。
( 5 ）数据加密：对存储和传输的数据进行加密处理，从而使得不知道解密算法的人无法获知数据的内容。

 

DB具有数据独立性的原因：三级模式结构
逻辑数据和物理数据的转换由DBMS负责
在嵌入式 SQL 中，当 SQL 语句中引用宿主语言的程序变量时，程序变量应加前缀：
在关系代数表达式的查询优化中，不正确的叙述是 尽可能早地执行连接
下列哪类不属于计算机系统的安全问题 政策安全类
数据库设计人员和用户之间沟通信息的桥梁是 实体联系图
并行数据库系统研究一直以三种并行计算结构为基础，分别是 共享内存结构、共享磁盘结构、无共享资源结构
RDBMS查询处理可以分为四个阶段，包括 查询分析、检查、优化、执行