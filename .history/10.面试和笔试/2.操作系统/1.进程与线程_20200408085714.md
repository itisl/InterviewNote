# 进程与线程
## 进程
* 进程实体的运行过程（动态的）
* 系统进行资源分配和调度的独立单位
### 进程实体
> 1. 程序段：程序的代码等
> 2. 数据段：程序处理的数据和变量
> 3. PCB（进程存在唯一标志）
>    - 进程描述信息：进程标识符PID，用户标识符UID
>    - 进程控制和管理信息
>         * 进程当前状态
>         * 进程优先级
>     - 资源分配清单
>         * 程序段指针
>         * 数据段指针
>         * 外设
>     * 处理机相关信息
>         * 各种寄存器的值
### 状态转换

![20200408085256](https://i.loli.net/2020/04/08/hjyuFxCmdaWeJBU.png)
> * 就绪态-->运行态：程序被调度，CPU开始执行
> * 运行态-->就绪态：时间片用完或者更高优先级的进程执行
> * 运行态-->阻塞态：进程通过系统调用申请某种资源(如打印机等)，请求等待事件发生完才能继续执行（主动行为）
> * 阻塞态-->就绪态：申请的资源被分配，可以继续执行（被动行为）
### 进程控制
* 作用：实现进程状态转换
* 原语
    * 进程创建fork()
     * > pid_t fork(void);
     * > 新进程是当前进程的子进程，子进程是父进程的复制，子进程开始和父进程并发运行fork()函数后续代码
     * > exec()函数簇
     * > 装入一个可执行程序，使子进程具有新功能

### 进程通信
• 管道（PIPE）
• 有名管道：一种半双工的通信方式，它允许无亲缘关系进程间的通信
• 优点：可以实现任意关系的进程间的通信
• 缺点：
1. 长期存于系统中，使用不当容易出错
2. 缓冲区有限
• 无名管道：一种半双工的通信方式，只能在具有亲缘关系的进程间使用（父子进程）
• 优点：简单方便
• 缺点：
1. 局限于单向通信
2. 只能创建在它的进程以及其有亲缘关系的进程之间
3. 缓冲区有限
• 信号量（Semaphore）：一个计数器，可以用来控制多个线程对共享资源的访问
• 优点：可以同步进程
• 缺点：信号量有限
• 信号（Signal）：一种比较复杂的通信方式，用于通知接收进程某个事件已经发生
• 消息队列（Message Queue）：是消息的链表，存放在内核中并由消息队列标识符标识
• 优点：可以实现任意进程间的通信，并通过系统调用函数来实现消息发送和接收之间的同步，无需考虑同步问题，方便
• 缺点：信息的复制需要额外消耗 CPU 的时间，不适宜于信息量大或操作频繁的场合
• 共享内存（Shared Memory）：映射一段能被其他进程所访问的内存，这段共享内存由一个进程创建，但多个进程都可以访问
• 优点：无须复制，快捷，信息量大
• 缺点：
ⅰ. 通信是通过将共享空间缓冲区直接附加到进程的虚拟地址空间中来实现的，因此进程间的读写操作的同步问题
ⅱ. 利用内存缓冲区直接交换信息，内存的实体存在于计算机中，只能同一个计算机系统中的诸多进程共享，不方便网络通信
• 套接字（Socket）：可用于不同及其间的进程通信
• 优点：
ⅰ. 传输数据为字节级，传输数据可自定义，数据量小效率高
ⅱ. 传输数据时间短，性能高
ⅲ. 适合于客户端和服务器端之间信息实时交互
ⅳ. 可以加密,数据安全性强
• 缺点：需对传输的数据进行解析，转化成应用级的数据。

## 线程
### 线程概念
* 一个进程可能需要同时处理不同的事情
* 线程是基本的CPU执行单元
* 各线程可以并发，提高系统的并发度
* 引入线程后，进程作为基本的资源分配单元
