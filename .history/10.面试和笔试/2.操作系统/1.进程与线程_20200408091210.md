# 进程与线程
## 进程
* 进程实体的运行过程（动态的）
* 系统进行资源分配和调度的独立单位
### 进程实体
> 1. 程序段：程序的代码等
> 2. 数据段：程序处理的数据和变量
> 3. PCB（进程存在唯一标志）
>    - 进程描述信息：进程标识符PID，用户标识符UID
>    - 进程控制和管理信息
>         * 进程当前状态
>         * 进程优先级
>     - 资源分配清单
>         * 程序段指针
>         * 数据段指针
>         * 外设
>     * 处理机相关信息
>         * 各种寄存器的值
### 状态转换

![20200408085256](https://i.loli.net/2020/04/08/hjyuFxCmdaWeJBU.png)
> * 就绪态-->运行态：程序被调度，CPU开始执行
> * 运行态-->就绪态：时间片用完或者更高优先级的进程执行
> * 运行态-->阻塞态：进程通过系统调用申请某种资源(如打印机等)，请求等待事件发生完才能继续执行（主动行为）
> * 阻塞态-->就绪态：申请的资源被分配，可以继续执行（被动行为）

### [父进程与子进程](https://blog.csdn.net/nan_lei/article/details/81636473)

**进程创建`fork()`函数**

```cpp
pid_t fork();
// 返回值0代表子进程，>0代表父进程，值为子进程PID，-1代表出错，在两个进程中返回两个值
```
复制父进程的资源需要大量的操作，十分浪费时间与系统资源，因此Linux内核采取了**写时拷贝技术**（copy on write）来提高效率
> **相同**：子进程完全复制了父进程的资源，包括进程上下文、代码区、数据区、堆区、栈区、内存信息、打开文件的文件描述符、信号处理函数、进程优先级、进程组号、当前工作目录、根目录、资源限制和控制终端等信息
> **区别**：子进程与父进程的区别有进程号、资源使用情况和计时器等。

**`exec`函数族**
提供了让进程运行另一个程序的方法。exec函数族内的函数可以根据指定的文件名或目录名找到可执行程序，并加载新的可执行程序，替换掉旧的代码区、数据区、堆区、栈区与其他系统资源。这里的可执行程序既可以是二进制文件，也可以是脚本文件。在执行exec函数族函数后，除了该进程的进程号PID，其他内容都被替换了。

#### 孤儿进程、僵尸进程和守护进程
##### 守护进程
**守护进程**是一类在后台工作的特殊进程，通常情况下，守护进程用于执行特定的系统任务。守护进程却能够（或者说，必须）突破终端的限制，不受终端的影响在后台工作。许多的系统服务都是通过守护进程实现的
> 编写一个守护进程的步骤如下：
> 1.创建子进程，父进程退出
> 2.在子进程内创建新会话
> 3.改变工作目录
> 4.重设文件权限掩码
> 5.关闭文件描述符

##### 孤儿进程
孤儿进程指的是在其父进程执行完成或被终止后仍继续运行的一类进程，其会被init进程收养

##### 僵尸进程